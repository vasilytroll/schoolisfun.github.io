<script>
// Welcome button click → Show login overlay
document.getElementById('welcome-button').addEventListener('click', () => {
  document.getElementById('welcome-container').style.display = 'none';
  document.getElementById('login-overlay').style.display = 'flex';
});

// Login button → Show loading then portal
document.getElementById('login-button').addEventListener('click', () => {
  const email = document.getElementById('email-input').value;
  const password = document.getElementById('password-input').value;

  if (email && password) {
    document.getElementById('login-overlay').style.display = 'none';
    const loadingScreen = document.getElementById('loading-screen');
    loadingScreen.classList.remove('hidden');

    setTimeout(() => {
      loadingScreen.classList.add('hidden');
      document.getElementById('game-portal').classList.remove('hidden');
    }, 2000); // Simulate loading delay
  } else {
    alert('Please enter both username and password.');
  }
});

// Game card click → Open game in new tab or show error
document.querySelectorAll('.game-card').forEach(card => {
  card.addEventListener('click', () => {
    const url = card.getAttribute('data-url');
    try {
      const win = window.open(url, '_blank', 'noopener,noreferrer');
      if (!win || win.closed || typeof win.closed === 'undefined') {
        throw new Error('Popup blocked');
      }
    } catch (error) {
      const errorTemplate = document.getElementById('error-message-template').cloneNode(true);
      errorTemplate.classList.remove('hidden');
      document.body.appendChild(errorTemplate);

      errorTemplate.querySelector('button').addEventListener('click', () => {
        errorTemplate.remove();
      });
    }
  });
});

// Panic Button → Redirect to safe site
document.getElementById('panic-button').addEventListener('click', () => {
  window.location.href = 'https://www.google.com'; // Change to your preferred safe site
});

// Settings toggle
document.getElementById('settings-tab').addEventListener('click', () => {
  document.getElementById('settings-screen').classList.remove('hidden');
});

document.getElementById('close-settings-btn').addEventListener('click', () => {
  document.getElementById('settings-screen').classList.add('hidden');

  const selectedColor = document.getElementById('bg-color-picker').value;
  document.body.style.backgroundColor = selectedColor;

  const theme = document.getElementById('theme-selector').value;
  applyTheme(theme);

  const key = document.getElementById('panic-key').value.trim().toUpperCase();
  if (key.length === 1) {
    panicKey = key;
  }
});

// Theme switcher logic
function applyTheme(theme) {
  document.body.classList.remove('dark-theme', 'light-theme', 'neon-theme');
  if (theme === 'dark') {
    document.body.classList.add('dark-theme');
  } else if (theme === 'light') {
    document.body.classList.add('light-theme');
  } else if (theme === 'neon') {
    document.body.classList.add('neon-theme');
  }
}

// Panic key handling
let panicKey = null;
document.addEventListener('keydown', (e) => {
  if (panicKey && e.key.toUpperCase() === panicKey) {
    window.location.href = 'https://www.google.com'; // Change to your preferred safe site
  }
});
</script>
